<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Roku Remote</title>
		<script src="https://kit.fontawesome.com/e4862ea8a4.js" crossorigin="anonymous"></script>
		
		<style>
			* {
				position: absolute;
			}

			body {
				background-color: #222222;
			}

			button {
				position: absolute;
				border: none;
				font-size: 5vh;
				font-weight: bolder;
			}

			i {
				position: relative;
			}

			/* TV Input (populated by getDevices()) */
			#deviceList {
				width: 50vw;
				height: 5vh;
				position: absolute;
				top: 2vh;
				left: 22.5vw;
			}

			/* Power Buttons */
			#PowerOn, #PowerOff {
				top: 1vh;
				width: 16vw;
				height: 16vw;
				border-radius: 8vw;
			}
			#PowerOn {
				background-color: green;
				left: 2vw;
			}
			#PowerOff {
				background-color: red;
				left: 78vw;
			}

			/* Home and Back Buttons */
			#Home, #Back {
				font-size: 7vh;
				color: white;
				background-color: purple;
				width: 30vw;
				height: 10vh;
				top: 12vh;
				border-radius: 5vw;
			}
			#Home {
				left: 55vw;
			}
			#Back {
				left: 10vw;
			}

			/* Arrow Pad */
			#Up, #Down, #Left, #Right {
				font-size: 10vh;
				color: white;
				background-color: purple;
				width: 25vw;
				height: 25vw;
				border-radius: 5vw;
			}
			#Up {
				top: 25vh;
				left: 35vw;
			}
			#Down {
				top: 50vh;
				left: 35vw;
			}
			#Left {
				top: 37.5vh;
				left: 10vw;
			}
			#Right {
				top: 37.5vh;
				left: 60vw;
			}
			#Select {
				background-color: purple;
				width: 22vw;
				height: 22vw;
				border-radius: 10vw;
				top: 38vh;
				left: 36.5vw;
			}

		</style>
	</head>
	<body>

		<div id="remote">
			<!-- TV Input (populated by getDevices()) -->
			<select id="deviceList"></select>

			<!-- Power Buttons -->
			<button id="PowerOn" class="keypress">
				<i class="fa-solid fa-power-off"></i>
			</button>
			<button id="PowerOff" class="keypress">
				<i class="fa-solid fa-power-off"></i>
			</button>

			<!-- Home and Back Buttons -->
			<button id="Home" class="keypress">
				<i class="fa-solid fa-house"></i>
			</button>
			<button id="Back" class="keypress">
				<i class="fa-solid fa-left-long"></i>
			</button>

			<!-- Arrow Pad -->
			<div id="ArrowPadBase"></div>
			<button id="Up" class="keypress">
				<i class="fa-solid fa-chevron-up"></i>
			</button>
			<button id="Down" class="keypress">
				<i class="fa-solid fa-chevron-down"></i>
			</button>
			<button id="Left" class="keypress">
				<i class="fa-solid fa-chevron-left"></i>
			</button>
			<button id="Right" class="keypress">
				<i class="fa-solid fa-chevron-right"></i>
			</button>
			<button id="Select" class="keypress"></button>
		</div>

	</body>
	<script type="text/javascript">

		// Get the found devices and put them in the dropdown
		let dropdown = document.querySelector("#deviceList");
		let xmlHttp = new XMLHttpRequest();
		xmlHttp.open("GET", "/devices", false);
		xmlHttp.send(null);
		xmlHttp.responseText.split("\r\n")[0].split(",").forEach((device) => {
			let newOption = document.createElement("option");
			newOption.setAttribute("value", device);
			newOption.appendChild(document.createTextNode(device));
			dropdown.appendChild(newOption);
		});

		// Register an event listener on every keypress button
		// to make it control the TV
		document.querySelectorAll(".keypress").forEach((button) => {
			const command = button.id;
			button.addEventListener("click", () => {
				let commandReq = new XMLHttpRequest();
				commandReq.open("PUT", "/keypress", false);
				commandReq.send("device=" + document.querySelector("#deviceList").value + "&action=" + command);
			});
		});

	</script>
</html>